<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- materials -->
  <material name="blue"><color rgba="0 0.2 0.9 1"/></material>
  <material name="gray"><color rgba="0.1 0.1 0.1 1"/></material>
  <material name="darkBlue"><color rgba="0 0 0.1 1"/></material>

  <!-- reusable wheel macro -->
  <xacro:macro name="wheel" params="name x y z roll pitch yaw">
    <link name="${name}">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="0.05"/>
        <inertia ixx="0.0005204166666666667" ixy="0" ixz="0"
                 iyy="0.0005204166666666667" iyz="0" izz="0.0010000000000000002"/>
      </inertial>

      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry><cylinder radius="0.2" length="0.07"/></geometry>
        <material name="gray"/>
      </visual>

      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <!-- sphere collision -->
        <geometry><sphere radius="0.2"/></geometry>
      </collision>
    </link>

    <joint name="${name}_joint" type="continuous">
      <parent link="chassis"/>
      <child  link="${name}"/>
      <origin xyz="${x} ${y} ${z}" rpy="${roll} ${pitch} ${yaw}"/>
      <axis xyz="0 0 -1"/>
    </joint>

    <gazebo reference="${name}">
      <material>Gazebo/Black</material>
      <mu1 value="0.2"/><mu2 value="0.2"/>
    </gazebo>
  </xacro:macro>

  <!-- core macro builds the base and four wheels -->
  <xacro:macro name="make_core">

    <link name="dummy_link"/>

    <link name="chassis">
      <visual>
        <geometry><box size="0.6 0.7 0.1"/></geometry>
        <origin xyz="0 0 0" rpy="0 0 1.57"/>
        <material name="darkBlue"/>
      </visual>

      <collision>
        <geometry><box size="0.6 0.7 0.1"/></geometry>
        <origin xyz="0 0 0" rpy="0 0 1.57"/>
      </collision>

      <inertial>
        <origin xyz="0 0 0" rpy="0 0 1.57"/>
        <mass value="0.1"/>
        <inertia ixx="0.004166666666666666" ixy="0" ixz="0"
                 iyy="0.0030833333333333333" iyz="0" izz="0.007083333333333332"/>
      </inertial>
    </link>

    <joint name="chassis_joint" type="fixed">
      <parent link="dummy_link"/>
      <child  link="chassis"/>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </joint>

    <gazebo reference="chassis">
      <material>Gazebo/DarkMagentaTransparent</material>
    </gazebo>

    <!-- wheel placements -->
    <xacro:wheel name="LF_wheel" x="0.333"  y="0.333"  z="0" roll="0" pitch="1.57" yaw="-1.57"/>
    <xacro:wheel name="LB_wheel" x="-0.333" y="0.333"  z="0" roll="0" pitch="1.57" yaw="-1.57"/>
    <xacro:wheel name="RF_wheel" x="0.333"  y="-0.333" z="0" roll="0" pitch="1.57" yaw="-1.57"/>
    <xacro:wheel name="RB_wheel" x="-0.333" y="-0.333" z="0" roll="0" pitch="1.57" yaw="-1.57"/>

  </xacro:macro>

</robot>
